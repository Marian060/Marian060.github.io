<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blackjack</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        #game {
            display: none;
        }
        .card {
            display: inline-block;
            width: 50px;
            height: 70px;
            border: 1px solid black;
            margin: 5px;
            text-align: center;
            line-height: 70px;
            font-size: 24px;
            border-radius: 5px;
        }
        #resultado {
            font-size: 20px;
            font-weight: bold;
        }
        #puntuacion {
            font-size: 24px;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
    </style>
</head>
<body>
    <p>HECHO CON CHATGPT (ni de coña hago yo esto todavía)</p>
    <div id="Blackjack">
    <h1>Juego de Blackjack</h1>
    <button id="iniciar">Iniciar Juego</button>
    
    <div id="game">
        <div id="jugador" class="mano"></div>
        <div id="dealer" class="mano"></div>
        <div id="resultado"></div>
        <div id="puntuacion"></div>
        <button id="plantarse">Plantarse</button>
        <button id="pedir">Pedir Carta</button>
        <button id="reiniciar" style="display: none;">Repetir Juego</button>
    </div>
    </div>
    <script>
        const iniciarButton = document.getElementById('iniciar');
        const gameDiv = document.getElementById('game');
        const jugadorDiv = document.getElementById('jugador');
        const dealerDiv = document.getElementById('dealer');
        const resultadoDiv = document.getElementById('resultado');
        const puntuacionDiv = document.getElementById('puntuacion');
        const plantarseButton = document.getElementById('plantarse');
        const pedirButton = document.getElementById('pedir');
        const reiniciarButton = document.getElementById('reiniciar');

        let jugadorCartas = [];
        let dealerCartas = [];
        let juegoActivo = false;

        const barajarCartas = () => {
            const cartas = [];
            const palos = ['♥', '♦', '♣', '♠'];
            const valores = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
            for (let palo of palos) {
                for (let valor of valores) {
                    cartas.push({ valor, palo });
                }
            }
            return cartas.sort(() => Math.random() - 0.5);
        };

        const calcularPuntuacion = (cartas) => {
            let puntuacion = 0;
            let ases = 0;
            for (let carta of cartas) {
                if (carta.valor === 'A') {
                    ases++;
                    puntuacion += 11; // Inicialmente, el as cuenta como 11
                } else if (['J', 'Q', 'K'].includes(carta.valor)) {
                    puntuacion += 10;
                } else {
                    puntuacion += parseInt(carta.valor);
                }
            }
            while (puntuacion > 21 && ases > 0) {
                puntuacion -= 10; // Cambia un as de 11 a 1
                ases--;
            }
            return puntuacion;
        };

        const mostrarCartas = () => {
            jugadorDiv.innerHTML = '';
            dealerDiv.innerHTML = '';
            for (let carta of jugadorCartas) {
                jugadorDiv.innerHTML += `<div class="card">${carta.valor}${carta.palo}</div>`;
            }
            for (let carta of dealerCartas) {
                dealerDiv.innerHTML += `<div class="card">${carta.valor}${carta.palo}</div>`;
            }
            puntuacionDiv.textContent = `Total: ${calcularPuntuacion(jugadorCartas)}`;
        };

        const verificarJuego = () => {
            const puntuacionJugador = calcularPuntuacion(jugadorCartas);
            const puntuacionDealer = calcularPuntuacion(dealerCartas);
            if (puntuacionJugador > 21) {
                resultadoDiv.textContent = 'Te has pasado. ¡Perdiste!';
                juegoActivo = false;
            } else if (puntuacionDealer > 21) {
                resultadoDiv.textContent = 'El dealer se ha pasado. ¡Ganaste!';
                juegoActivo = false;
            } else if (puntuacionJugador === 21) {
                resultadoDiv.textContent = '¡Blackjack! ¡Ganaste!';
                juegoActivo = false;
            }
            if (!juegoActivo) {
                reiniciarButton.style.display = 'block'; // Mostrar botón al finalizar
            }
        };

        const jugar = () => {
            const mazo = barajarCartas();
            jugadorCartas = [mazo.pop(), mazo.pop()];
            dealerCartas = [mazo.pop(), mazo.pop()];
            juegoActivo = true;
            resultadoDiv.textContent = '';
            mostrarCartas();
            verificarJuego();
        };

        iniciarButton.onclick = () => {
            iniciarButton.style.display = 'none';
            gameDiv.style.display = 'block';
            jugar();
        };

        pedirButton.onclick = () => {
            if (juegoActivo) {
                const mazo = barajarCartas();
                jugadorCartas.push(mazo.pop());
                mostrarCartas();
                verificarJuego();
            }
        };

        plantarseButton.onclick = () => {
            if (juegoActivo) {
                while (calcularPuntuacion(dealerCartas) < 17) {
                    const mazo = barajarCartas();
                    dealerCartas.push(mazo.pop());
                }
                mostrarCartas();
                const puntuacionJugador = calcularPuntuacion(jugadorCartas);
                const puntuacionDealer = calcularPuntuacion(dealerCartas);
                if (puntuacionDealer > 21 || puntuacionJugador > puntuacionDealer) {
                    resultadoDiv.textContent = '¡Ganaste!';
                } else if (puntuacionJugador < puntuacionDealer) {
                    resultadoDiv.textContent = 'Perdiste.';
                } else {
                    resultadoDiv.textContent = 'Empate.';
                }
                juegoActivo = false;
                reiniciarButton.style.display = 'block'; // Mostrar botón al finalizar
            }
        };

        reiniciarButton.onclick = () => {
            jugadorCartas = [];
            dealerCartas = [];
            resultadoDiv.textContent = '';
            puntuacionDiv.textContent = '';
            jugar();
            reiniciarButton.style.display = 'none';
        };
    </script>
    
</body>
</html>
